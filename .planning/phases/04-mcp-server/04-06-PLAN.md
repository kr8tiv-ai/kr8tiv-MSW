---
phase: 04-mcp-server
plan: 06
type: execute
wave: 2
depends_on: ["04-01", "04-02"]
files_modified:
  - src/mcp/tools/msw-verify.ts
  - src/mcp/tools/msw-notebook-add.ts
autonomous: true

must_haves:
  truths:
    - "msw_verify checks implementation against requirements and returns results"
    - "msw_notebook_add adds notebook sources to MSW config"
  artifacts:
    - path: "src/mcp/tools/msw-verify.ts"
      provides: "msw_verify tool registrar"
      exports: ["registerMswVerify"]
    - path: "src/mcp/tools/msw-notebook-add.ts"
      provides: "msw_notebook_add tool registrar"
      exports: ["registerMswNotebookAdd"]
  key_links:
    - from: "src/mcp/tools/msw-notebook-add.ts"
      to: ".msw/config.json"
      via: "reads and updates notebookUrls array"
      pattern: "config\\.notebookUrls"
---

<objective>
Implement msw_verify (MCP-06) and msw_notebook_add (MCP-08) tools.

Purpose: msw_verify validates implementation against requirements. msw_notebook_add manages notebook sources in the MSW config.
Output: Two tool registrars â€” verify is synchronous, notebook_add is synchronous.
</objective>

<execution_context>
@C:\Users\lucid\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lucid\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-mcp-server/04-RESEARCH.md
@.planning/phases/04-mcp-server/04-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: msw_verify tool</name>
  <files>src/mcp/tools/msw-verify.ts</files>
  <action>
    Create `src/mcp/tools/msw-verify.ts` exporting `registerMswVerify(server: McpServer)`:

    Register tool "msw_verify" with description "Verify implementation against research requirements".

    Zod input schema:
    - projectDir: z.string().describe("Project directory with .msw/ config")
    - requirementIds: z.array(z.string()).optional().describe("Specific requirement IDs to verify (all if omitted)")

    Handler:
    1. Validate .msw/ exists
    2. Read research data from .msw/research/ directory
    3. Stub verification logic (Phase 5): for now, list all research files found and return a summary of { total: N, verified: 0, pending: N, requirements: [...filenames] }
    4. Wrap in try/catch, return isError on failure
  </action>
  <verify>`npx tsc --noEmit src/mcp/tools/msw-verify.ts`</verify>
  <done>msw_verify returns verification summary for project requirements</done>
</task>

<task type="auto">
  <name>Task 2: msw_notebook_add tool</name>
  <files>src/mcp/tools/msw-notebook-add.ts</files>
  <action>
    Create `src/mcp/tools/msw-notebook-add.ts` exporting `registerMswNotebookAdd(server: McpServer)`:

    Register tool "msw_notebook_add" with description "Add NotebookLM notebook sources to MSW project".

    Zod input schema:
    - projectDir: z.string().describe("Project directory with .msw/ config")
    - notebookUrl: z.string().describe("NotebookLM notebook URL to add")
    - label: z.string().optional().describe("Human-readable label for this notebook")

    Handler:
    1. Validate .msw/config.json exists
    2. Read config, parse JSON
    3. Add { url: notebookUrl, label, addedAt: ISO date } to config.notebookUrls array (avoid duplicates by URL)
    4. Write updated config back
    5. Return updated notebook list
  </action>
  <verify>`npx tsc --noEmit src/mcp/tools/msw-notebook-add.ts`</verify>
  <done>msw_notebook_add adds notebook URLs to .msw/config.json without duplicates</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds
2. Both tools handle missing .msw/ gracefully with error responses
</verification>

<success_criteria>
msw_verify and msw_notebook_add tools are registered and functional.
</success_criteria>

<output>
After completion, create `.planning/phases/04-mcp-server/04-06-SUMMARY.md`
</output>
