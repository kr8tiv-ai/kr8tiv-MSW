---
phase: 06-end-to-end-integration
plan: 05
type: execute
wave: 3
depends_on: ["06-01", "06-02", "06-03", "06-04"]
files_modified:
  - src/index.ts
  - src/pipeline/index.ts
  - src/config/index.ts
  - SETUP.md
autonomous: true

must_haves:
  truths:
    - "Clean public API exports all major modules from src/index.ts"
    - "SETUP.md enables a new user to install, configure, and run MSW from scratch"
    - "npm run build produces working dist/ with correct entry points"
  artifacts:
    - path: "src/index.ts"
      provides: "Root barrel export for the entire MSW library"
      contains: "export"
    - path: "src/pipeline/index.ts"
      provides: "Barrel export for pipeline module"
      exports: ["PipelineOrchestrator", "checkHealth", "saveCheckpoint"]
    - path: "src/config/index.ts"
      provides: "Barrel export for config module"
      exports: ["loadConfig", "MswConfigSchema"]
    - path: "SETUP.md"
      provides: "User-facing setup guide"
      contains: "mcp.json"
  key_links:
    - from: "src/index.ts"
      to: "src/browser/index.ts"
      via: "re-export"
      pattern: "export.*from.*browser"
    - from: "src/index.ts"
      to: "src/mcp/server.ts"
      via: "re-export createServer"
      pattern: "export.*from.*mcp"
---

<objective>
Create barrel exports for clean public API and write user-facing setup documentation.

Purpose: The project needs clean entry points for library consumers and MCP users, plus documentation so new users can set up MSW from scratch.
Output: Root barrel exports, module barrel exports for new modules, SETUP.md with complete instructions.
</objective>

<execution_context>
@C:\Users\lucid\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lucid\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@src/mcp/index.ts
@src/browser/index.ts
@src/bidirectional/index.ts
@src/knowledge/index.ts
@src/auto-conversation/index.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Barrel exports for new modules and root index</name>
  <files>src/index.ts, src/pipeline/index.ts, src/config/index.ts</files>
  <action>
Create src/config/index.ts:
- Export { MswConfigSchema, type MswConfig } from ./schema.js
- Export { loadConfig, validateConfig } from ./validator.js

Create src/pipeline/index.ts:
- Export { PipelineOrchestrator } from ./orchestrator.js
- Export { checkHealth, type HealthCheck } from ./health.js
- Export { saveCheckpoint, restoreCheckpoint, clearCheckpoint, type PipelineState } from ./state.js

Create src/index.ts (root barrel):
- Re-export from ./browser/index.js
- Re-export from ./auto-conversation/index.js
- Re-export from ./bidirectional/index.js
- Re-export from ./knowledge/index.js
- Re-export from ./planning/state-manager.js (or whatever planning barrel exists)
- Re-export from ./execution/iteration-tracker.js
- Re-export from ./config/index.js
- Re-export from ./pipeline/index.js
- Export { createServer } from ./mcp/server.js
- Do NOT re-export MCP tool registration functions (internal)

Use `export * from` for modules with their own barrel, `export { specific } from` for individual files.
  </action>
  <verify>Run `npm run build` â€” dist/index.js exists and all imports resolve. Run `npm run check` for type safety.</verify>
  <done>Clean public API with single import entry point. All modules accessible from root.</done>
</task>

<task type="auto">
  <name>Task 2: SETUP.md documentation</name>
  <files>SETUP.md</files>
  <action>
Create SETUP.md with these sections:

## Prerequisites
- Node.js 18+
- Chrome/Chromium installed
- Ollama installed and running (optional, for relevance scoring)
- Git configured (for research persistence)

## Installation
- git clone + npm install
- npx playwright install chromium
- npm run build

## Configuration
- MCP client config for Claude Code (.claude/mcp.json), Cursor (~/.cursor/mcp.json), Windsurf (~/.codeium/windsurf/mcp_config.json)
- Show exact JSON config block with command: "node", args: ["path/to/dist/mcp/index.js"]

## First Run
- Call msw_init with projectDir to create .msw/
- .msw/config.json fields: notebookUrl, relevanceThreshold, maxDepth, maxQueriesPerDay
- Call msw_status to verify health

## NotebookLM Setup
- First run requires manual Chrome login to Google account
- After login, Chrome profile persists auth across restarts
- Profile stored in default location (or custom via profileDir config)

## Available Tools
- Brief 1-line description of each of the 7 MCP tools

## Troubleshooting
- "Browser not found": npx playwright install chromium
- "Ollama unavailable": install ollama, relevance scoring degrades to keyword matching
- "Rate limit": 50 queries/day, use query batching
  </action>
  <verify>Read SETUP.md and confirm all sections present with accurate config examples.</verify>
  <done>New user can follow SETUP.md from zero to working MSW setup.</done>
</task>

</tasks>

<verification>
- `npm run build` succeeds with all barrel exports resolving
- `npm run check` passes
- SETUP.md contains all required sections
</verification>

<success_criteria>
Clean public API via src/index.ts. SETUP.md enables zero-to-working setup for new users.
</success_criteria>

<output>
After completion, create `.planning/phases/06-end-to-end-integration/06-05-SUMMARY.md`
</output>
