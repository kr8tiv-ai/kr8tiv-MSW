---
phase: 05-gsd-ralph-integration
plan: 05
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/planning/prd-generator.ts
autonomous: true

must_haves:
  truths:
    - "Generated PRDs include references to NotebookLM research findings"
    - "PRD includes sections: overview, requirements, constraints, research references"
  artifacts:
    - path: "src/planning/prd-generator.ts"
      provides: "PRD generation with research grounding"
      exports: ["generatePrd", "PrdConfig"]
  key_links:
    - from: "src/planning/prd-generator.ts"
      to: "src/knowledge/report-compiler.ts"
      via: "import for research report loading"
      pattern: "report-compiler"
---

<objective>
Create PRD generator that produces research-grounded planning documents with references to NotebookLM findings.

Purpose: GSD planning needs PRDs enriched with actual research, not just AI-generated specs.
Output: prd-generator.ts that reads research reports and generates PRDs with citations.
</objective>

<execution_context>
@C:\Users\lucid\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lucid\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/05-gsd-ralph-integration/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Research-grounded PRD generator</name>
  <files>src/planning/prd-generator.ts</files>
  <action>
  Create `src/planning/prd-generator.ts`:

  Interface `PrdConfig`: projectName, description, researchDir (path to .msw/research/), constraints (string[]), requirements (string[])

  Interface `ResearchReference`: query, answer (summary), source (notebook name), timestamp

  `loadResearchReports(researchDir: string): ResearchReference[]` -- reads all .md files in researchDir, extracts Q&A pairs using the metadata format from Phase 3's report-compiler (YAML frontmatter with query/answer fields)

  `generatePrd(config: PrdConfig): string` -- produces markdown PRD with sections:
  1. `# {projectName} - Product Requirements`
  2. `## Overview` -- config.description
  3. `## Requirements` -- numbered list from config.requirements
  4. `## Constraints` -- bulleted list from config.constraints
  5. `## Research References` -- for each ResearchReference: blockquote with query, answer summary, source attribution
  6. `## Generated` -- timestamp

  If no research reports found, include a note: "No NotebookLM research available. Consider running msw_research first."

  Use gray-matter for parsing research report frontmatter. Use fs sync.
  </action>
  <verify>`npx tsc --noEmit src/planning/prd-generator.ts` compiles.</verify>
  <done>PRD generator produces markdown with research citations. Empty research dir handled gracefully.</done>
</task>

</tasks>

<verification>
TypeScript compiles. PRD output contains research reference section.
</verification>

<success_criteria>
PRDs include NotebookLM research findings with source attribution.
</success_criteria>

<output>
After completion, create `.planning/phases/05-gsd-ralph-integration/05-05-SUMMARY.md`
</output>
