---
phase: 05-gsd-ralph-integration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/planning/gsd-adapter.ts
autonomous: true

must_haves:
  truths:
    - "MSW internal task format converts to GSD XML and back without data loss"
    - "Generated XML matches GSD plan format with task/name/files/action/verify/done elements"
  artifacts:
    - path: "src/planning/gsd-adapter.ts"
      provides: "Bidirectional MSW<->GSD XML conversion"
      exports: ["toGsdXml", "fromGsdXml", "MswTask"]
  key_links:
    - from: "src/planning/gsd-adapter.ts"
      to: "GSD PLAN.md format"
      via: "XML string generation/parsing"
      pattern: "<task.*>.*</task>"
---

<objective>
Create the GSD format adapter that translates between MSW internal task representation and GSD XML task format used in PLAN.md files.

Purpose: Enables MSW to generate and consume GSD-compatible plans.
Output: gsd-adapter.ts with toGsdXml and fromGsdXml functions.
</objective>

<execution_context>
@C:\Users\lucid\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lucid\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-gsd-ralph-integration/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: GSD XML adapter</name>
  <files>src/planning/gsd-adapter.ts</files>
  <action>
  Create `src/planning/gsd-adapter.ts` with:

  Interface `MswTask`: id, name, files (string[]), action, verify, done, type ('auto'|'checkpoint:human-verify'|'checkpoint:decision')

  `toGsdXml(tasks: MswTask[]): string` -- converts array to GSD XML format:
  ```xml
  <task type="auto">
    <name>Task 1: Name</name>
    <files>path/to/file.ts</files>
    <action>Implementation details</action>
    <verify>Verification command</verify>
    <done>Acceptance criteria</done>
  </task>
  ```

  `fromGsdXml(xml: string): MswTask[]` -- parses GSD XML back using regex (GSD XML is flat, no nesting -- regex is sufficient per research). Use regex `/<task[^>]*type="([^"]*)"[^>]*>([\s\S]*?)<\/task>/g` to extract tasks. Inner tags via `extractTag` helper.

  Handle edge cases: XML-escape special chars in toGsdXml (&, <, >, quotes). Files array joined with ", " in output, split on "," in parse.
  </action>
  <verify>`npx tsc --noEmit src/planning/gsd-adapter.ts` compiles. Round-trip test: `fromGsdXml(toGsdXml(tasks))` produces equivalent output.</verify>
  <done>Adapter converts MSW tasks to valid GSD XML and parses GSD XML back to MswTask objects.</done>
</task>

</tasks>

<verification>
TypeScript compiles. Round-trip conversion preserves data.
</verification>

<success_criteria>
MSW can generate GSD-compatible PLAN.md task sections and parse existing ones.
</success_criteria>

<output>
After completion, create `.planning/phases/05-gsd-ralph-integration/05-02-SUMMARY.md`
</output>
