---
phase: 01-browser-automation-foundation
plan: 06
type: execute
wave: 4
depends_on: ["01-05"]
files_modified:
  - src/browser/index.ts
  - src/notebooklm/index.ts
  - src/index.ts
autonomous: false

must_haves:
  truths:
    - "All modules export cleanly from barrel files"
    - "Full pipeline compiles: launch browser, connect to notebook, verify selectors, extract response"
    - "TypeScript build produces working dist/ output"
  artifacts:
    - path: "src/browser/index.ts"
      provides: "Barrel export for browser module"
      exports: ["BrowserDriver", "ProfileManager", "Selectors", "humanClick", "humanType", "waitForStreamingComplete"]
    - path: "src/notebooklm/index.ts"
      provides: "Barrel export for notebooklm module"
      exports: ["NotebookNavigator", "ResponseExtractor"]
    - path: "src/index.ts"
      provides: "Top-level barrel export"
  key_links:
    - from: "src/index.ts"
      to: "src/browser/index.ts"
      via: "re-export"
      pattern: "export.*from.*browser"
    - from: "src/index.ts"
      to: "src/notebooklm/index.ts"
      via: "re-export"
      pattern: "export.*from.*notebooklm"
---

<objective>
Create barrel exports, verify the full compilation pipeline, and run a manual smoke test against a real NotebookLM notebook.

Purpose: Validate that all Phase 1 components integrate correctly and the browser actually launches, connects, and can interact with NotebookLM.
Output: Barrel exports, clean build, and human-verified smoke test.
</objective>

<execution_context>
@C:\Users\lucid\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lucid\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-browser-automation-foundation/01-RESEARCH.md
@.planning/phases/01-browser-automation-foundation/01-01-SUMMARY.md
@.planning/phases/01-browser-automation-foundation/01-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create barrel exports and verify build</name>
  <files>src/browser/index.ts, src/notebooklm/index.ts, src/index.ts</files>
  <action>
  **src/browser/index.ts:** Re-export all public symbols:
  ```typescript
  export { BrowserDriver } from './driver';
  export { ProfileManager } from './profile';
  export { Selectors, validateSelectors } from './selectors';
  export { configureStealthBrowser } from './stealth';
  export { randomDelay, humanType, humanClick, humanScroll } from './humanize';
  export { waitForStreamingComplete, waitForElement } from './wait';
  ```

  **src/notebooklm/index.ts:** Re-export:
  ```typescript
  export { NotebookNavigator } from './navigator';
  export { ResponseExtractor } from './extractor';
  ```

  **src/index.ts:** Re-export both modules:
  ```typescript
  export * from './browser';
  export * from './notebooklm';
  export * from './types/browser';
  ```

  Add `"build": "tsc"` script to package.json if not present.
  Run `npm run build` and verify dist/ output is correct.
  Run `npx tsc --noEmit` for type checking.
  </action>
  <verify>
  `npm run build` succeeds with zero errors.
  `ls dist/browser/ dist/notebooklm/` shows compiled .js and .d.ts files.
  </verify>
  <done>All modules export from barrel files, TypeScript builds to dist/ cleanly</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 1 browser automation foundation: BrowserDriver with stealth, ProfileManager with locking, NotebookNavigator, selector registry, humanized interactions, and streaming response extraction.</what-built>
  <how-to-verify>
  1. Run `npm run build` — should compile with zero errors
  2. Create a test script `test-smoke.ts` (or have Claude create it) that:
     a. Creates BrowserDriver with default config
     b. Launches browser (a visible Chrome window should appear)
     c. Creates NotebookNavigator with the page
     d. Connects to a known NotebookLM notebook URL
     e. Runs validateSelectors() and logs results
     f. Logs "Smoke test passed" or reports which selectors failed
  3. Run the smoke test: `npx tsx test-smoke.ts`
  4. Verify:
     - Browser window opens (headful, not headless)
     - NotebookLM loads (you may need to log in manually on first run)
     - Chat input is detected
     - Lock file exists at ~/.msw/chrome-profile/.lock
  5. Close and re-run — should skip login (session persisted)
  </how-to-verify>
  <resume-signal>Type "approved" if smoke test passes, or describe which selectors/steps failed so they can be adjusted.</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` produces dist/ with all modules
2. Barrel exports allow `import { BrowserDriver, NotebookNavigator } from './dist'`
3. Smoke test launches browser and connects to NotebookLM
</verification>

<success_criteria>
Phase 1 is complete when: browser launches with stealth, profile persists auth across restarts, NotebookLM chat UI is detected via semantic selectors, and response extraction waits for streaming completion.
</success_criteria>

<output>
After completion, create `.planning/phases/01-browser-automation-foundation/01-06-SUMMARY.md`
</output>
